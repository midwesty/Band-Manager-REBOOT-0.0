/* Bandscape v5.2 â€“ Keys & Rooms (keeps prior layout) */
*{box-sizing:border-box} html,body{height:100%}
body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;background:#0f0f12;color:#eee;overflow:hidden;display:flex;align-items:center;justify-content:center}
#game{position:relative;width:1024px;height:640px}
#room-bg{position:absolute;inset:0;width:1024px;height:640px;object-fit:cover;filter:contrast(1.03) brightness(.95)}
#hover-label{position:absolute;left:12px;top:12px;background:rgba(0,0,0,.55);border:1px solid rgba(255,255,255,.15);padding:6px 10px;border-radius:10px;font-size:12px;pointer-events:none;z-index:55}

.hotspot{position:absolute;border:2px solid rgba(127,209,255,.0);border-radius:10px;cursor:pointer;z-index:20}
.hotspot.pulse{animation:pulse 1.2s infinite;border-color:rgba(127,209,255,.65);box-shadow:0 0 0 0 rgba(127,209,255,.35)}
.hotspot.used{border-color:rgba(127,209,255,.0)}
@keyframes pulse{0%{box-shadow:0 0 0 0 rgba(127,209,255,.45)}70%{box-shadow:0 0 0 10px rgba(127,209,255,0)}100%{box-shadow:0 0 0 0 rgba(127,209,255,0)}}

#phone-btn{position:absolute;right:20px;bottom:20px;width:56px;height:56px;border-radius:50%;background:#1f1f24;color:#fff;border:1px solid #333;font-size:24px;cursor:pointer;z-index:40}
#use-btn{position:absolute;right:92px;bottom:20px;background:#218838;color:#fff;border:none;border-radius:8px;padding:10px 16px;font-weight:700;cursor:pointer;z-index:40}
.hidden{display:none!important}

/* Keymap */
#keymap{position:absolute;right:380px;bottom:84px;width:460px;background:#121219;border:1px solid #2a2a35;border-radius:10px;padding:10px 12px;z-index:61}
#keymap h4{margin:0 0 6px;font-size:14px}
.keymap-header{display:flex;align-items:center;justify-content:space-between;gap:12px}
.select-key{font-size:12px;opacity:.9}
.select-key select{background:#171722;border:1px solid #2a2a35;color:#fff;border-radius:8px;padding:4px 6px}
.kb{margin-top:10px}
.kb .row{display:flex;gap:6px;margin-bottom:6px}
.kb .row > div{flex:1;background:#15151b;border:1px solid #2a2a35;border-radius:10px;height:56px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:4px}
.kb .k{font-size:11px;opacity:.85}
.kb .lbl{font-size:12px;font-weight:700}
.kb .hit{outline:2px solid rgba(255,212,0,.9);box-shadow:0 0 0 4px rgba(255,212,0,.18)}
.hint{opacity:.8;font-size:12px;margin:10px 0 0}

/* Phone */
#phone{position:absolute;right:16px;bottom:84px;width:360px;height:580px;background:#0b0b0f;border:2px solid #333;border-radius:24px;overflow:hidden;z-index:60;box-shadow:0 12px 24px rgba(0,0,0,.6)}
.phone-header{display:flex;align-items:center;justify-content:space-between;padding:8px 12px;background:linear-gradient(180deg,#14141a,#0d0d12);border-bottom:1px solid #23232a}
.phone-header .status{font-size:12px;opacity:.85} .phone-header button{background:#2a2a31;color:#eee;border:1px solid #3a3a45;border-radius:8px;padding:4px 8px;cursor:pointer}
.phone-crack{position:absolute;inset:0;background-image:radial-gradient(transparent,transparent 60%,rgba(255,255,255,.06) 61%);pointer-events:none}

.app-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;padding:14px} .app{height:70px;border-radius:16px;border:1px solid #2a2a35;background:#15151b;color:#fff;cursor:pointer;font-size:18px}
.app-view{padding:12px;height:calc(580px - 70px - 40px);overflow:auto} .scrollable{overflow:auto}
.app-pane h3{margin:6px 0 12px}
.stats-grid{display:grid;grid-template-columns:1fr 1fr;gap:6px 12px;background:#121219;border:1px solid #272736;padding:10px;border-radius:10px}
#buff-list{padding-left:16px;max-height:160px;overflow:auto}

/* Inventory */
.inv-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;padding:8px;background:#121219;border:1px solid #272736;border-radius:10px;min-height:120px}
.slot{width:72px;height:72px;border:1px dashed #353545;border-radius:8px;display:flex;align-items:center;justify-content:center;position:relative}
.slot img{width:54px;height:54px;object-fit:contain}
.qty{position:absolute;right:6px;bottom:4px;background:rgba(0,0,0,.7);border:1px solid rgba(255,255,255,.25);border-radius:8px;padding:1px 6px;font-size:12px}

/* Modal */
#modal{position:absolute;inset:0;background:rgba(0,0,0,.65);display:grid;place-items:center;z-index:70}
#modal-content{width:560px;max-width:90vw;background:#16161d;border:1px solid #2a2a35;border-radius:12px;padding:16px}

/* Piano roll & patterns */
#piano-roll{margin-top:8px;height:220px;background:#0d0d14;border:1px solid #24243a;border-radius:8px;position:relative;overflow:hidden}
.pr-grid{position:absolute;inset:0;display:grid;grid-template-columns:repeat(32,1fr);grid-template-rows:repeat(7,1fr)}
.pr-cell{border-right:1px solid #1a1a24;border-bottom:1px solid #1a1a24}
.pr-note{background:rgba(255,212,0,.8);border:1px solid rgba(255,255,255,.3);border-radius:4px}
#pattern-list .pattern{display:flex;align-items:center;justify-content:space-between;border:1px solid #25253a;background:#141420;padding:10px;border-radius:10px;margin-bottom:10px}

/* DAW */
#daw{position:absolute;inset:0;background:rgba(0,0,0,.75);z-index:80;display:grid;place-items:center}
.daw-box{width:980px;max-width:96vw;max-height:88vh;background:#101018;border:1px solid #2a2a35;border-radius:12px;overflow:hidden;display:flex;flex-direction:column}
.daw-header{display:flex;align-items:center;justify-content:space-between;background:#121222;border-bottom:1px solid #24243a;padding:10px 12px}
.daw-controls{display:flex;gap:8px;flex-wrap:wrap}
.daw-controls button{background:#1b1b26;border:1px solid #2a2a35;color:#fff;border-radius:10px;padding:8px 10px;cursor:pointer}
.daw-timeline{position:relative;flex:1;background:linear-gradient(90deg,rgba(255,255,255,.06) 1px,transparent 1px);background-size:16px 100%;overflow:auto}
#playhead{position:absolute;top:0;bottom:0;width:2px;background:rgba(127,209,255,.8);left:0}

/* Band Manager */
#bandmgr{position:absolute;inset:0;background:rgba(0,0,0,.75);z-index:85;display:grid;place-items:center}
.bm-wrap{width:920px;max-width:96vw;max-height:88vh;background:#101018;border:1px solid #2a2a35;border-radius:12px;display:flex;flex-direction:column;overflow:hidden}
.bm-header{display:flex;align-items:center;justify-content:space-between;background:#121222;border-bottom:1px solid #24243a;padding:10px 12px}
.bm-body{display:grid;grid-template-columns:1fr 2fr;gap:0;height:100%}
.bm-pane{padding:12px;overflow:auto}
#bm-bands{list-style:none;padding:0;margin:10px 0}
#bm-bands li{display:flex;align-items:center;justify-content:space-between;border:1px solid #26263a;background:#151524;padding:8px;border-radius:8px;margin-bottom:8px}
#bm-bands li .meta{opacity:.8;font-size:12px}
.bm-toolbar{display:flex;gap:8px}
.bm-detail-head{display:flex;align-items:center;justify-content:space-between;background:#131321;border:1px solid #23233a;border-radius:8px;padding:10px;margin-bottom:10px}
.bm-avatars{display:flex;gap:8px}
.bm-avatars .avatar{width:42px;height:42px;border-radius:12px;background:#1b1b2a;border:1px solid #2a2a35;display:grid;place-items:center}
.bm-tabs{display:flex;gap:8px;margin:10px 0}
.bm-tabs button{background:#1b1b26;border:1px solid #2a2a35;color:#fff;border-radius:10px;padding:8px 10px;cursor:pointer}
.bm-tabs button.active{outline:2px solid rgba(255,212,0,.7)}
.bm-tab{min-height:120px;background:#121219;border:1px solid #272736;border-radius:10px;padding:10px}
.bm-detail-actions{display:flex;gap:8px}

/* Travel */
#travel{position:absolute;inset:0;background:rgba(0,0,0,.75);z-index:86;display:grid;place-items:center}
.travel-wrap{width:520px;max-width:94vw;background:#101018;border:1px solid #2a2a35;border-radius:12px;padding:12px}
.travel-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px}
.travel-opt{width:100%;padding:12px;border-radius:10px;background:#1b1b26;border:1px solid #2a2a35;color:#fff;cursor:pointer;margin-bottom:8px}

/* === Scroll + layout fixes (v5.2.1) === */
/* Phone: make inner panes scroll reliably */
#phone{display:flex;flex-direction:column}
.app-grid{flex:0 0 auto}
.app-view{flex:1 1 auto;min-height:0;height:auto;overflow:auto;padding:12px}
.app-pane{min-height:0}
.buffs{min-height:0}

/* Modal: keep buttons visible and body scrollable */
#modal-content{display:flex;flex-direction:column;max-height:85vh;overflow:hidden}
#modal-body{flex:1 1 auto;min-height:0;overflow:auto}
#modal .modal-actions{flex:0 0 auto}

/* Band Manager: ensure tab body can scroll and actions stay visible */
.bm-wrap{height:88vh;max-height:88vh}
.bm-body{flex:1 1 auto;min-height:0;height:auto}
.bm-pane{display:flex;flex-direction:column;min-height:0}
#bm-bands{flex:1 1 auto;min-height:0;overflow:auto}
.bm-tabbody{flex:1 1 auto;min-height:0;overflow:auto}
.bm-detail-actions{flex:0 0 auto;margin-top:10px}

/* Pattern list inside phone: scroll within the pane */
#pattern-list{max-height:none}
